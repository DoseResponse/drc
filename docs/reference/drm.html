<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Fitting dose-response models — drm • drc</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Fitting dose-response models — drm" />

<meta property="og:description" content="A general model fitting function for analysis of concentration/dose/time-effect/response data." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">drc</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">3.0.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fitting dose-response models</h1>
    
    <div class="hidden name"><code>drm.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>A general model fitting function for analysis of concentration/dose/time-effect/response data.</p>
    
    </div>

    <pre class="usage"><span class='fu'>drm</span>(<span class='no'>formula</span>, <span class='no'>curveid</span>, <span class='no'>pmodels</span>, <span class='no'>weights</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>subset</span>, <span class='no'>fct</span>,
  <span class='kw'>type</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"continuous"</span>, <span class='st'>"binomial"</span>, <span class='st'>"Poisson"</span>, <span class='st'>"negbin1"</span>, <span class='st'>"negbin2"</span>, <span class='st'>"event"</span>, <span class='st'>"ssd"</span>),
  <span class='kw'>bcVal</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>bcAdd</span> <span class='kw'>=</span> <span class='fl'>0</span>,
  <span class='no'>start</span>, <span class='kw'>na.action</span> <span class='kw'>=</span> <span class='no'>na.omit</span>, <span class='kw'>robust</span> <span class='kw'>=</span> <span class='st'>"mean"</span>, <span class='kw'>logDose</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>control</span> <span class='kw'>=</span> <span class='fu'><a href='drmc.html'>drmc</a></span>(), <span class='kw'>lowerl</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>upperl</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>separate</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>pshifts</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>formula</th>
      <td><p>a symbolic description of the model to be fit. Either of the form 'response \(~\) dose' 
  or as a data frame with response values in first column and dose values in second column.</p></td>
    </tr>
    <tr>
      <th>curveid</th>
      <td><p>a numeric vector or factor containing the grouping of the data.</p></td>
    </tr>
    <tr>
      <th>pmodels</th>
      <td><p>a data frame with a many columns as there are parameters in the non-linear function. 
  Or a list containing a formula for each parameter in the nonlinear function.</p></td>
    </tr>
    <tr>
      <th>weights</th>
      <td><p>a numeric vector containing weights. For continuous/quantitative responses weights are multiplied inside the squared errors (see the details below).
    For binomial reponses weights provide information about the total number of binary observations used to obtain the response (which is a proportion): 
    1/2 and 10/20 lead to different analyses due to the different totals (2 vs. 20) even though the proportion in both cases is 0.5.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>an optional data frame containing the variables in the model.</p></td>
    </tr>
    <tr>
      <th>subset</th>
      <td><p>an optional vector specifying a subset of observations to be used in the fitting process.</p></td>
    </tr>
    <tr>
      <th>fct</th>
      <td><p>a list with three or more elements specifying the non-linear
  function, the accompanying self starter function, the names of the parameter in the non-linear function and, 
  optionally, the first and second derivatives as well as information used for calculation of ED values.
  Currently available functions include, among others, the four- and five-parameter log-logistic models 
  <code><a href='LL.4.html'>LL.4</a></code>, <code><a href='LL.5.html'>LL.5</a></code> and the Weibull model <code><a href='W4.html'>W1.4</a></code>. Use
  <code><a href='getMeanFunctions.html'>getMeanFunctions</a></code> for a full list.</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>a character string specifying the distribution of the data (parameter estimation will depend on the assumed distribution as different log likelihood functions will be used). 
  The default is "continuous", corresponding to assuming a normal distribution. The choices "binary" and "event" imply a binomial and multinomial distribution, respectively. The choice "ssd" is for fitting a species sensitivity
  distribution.</p></td>
    </tr>
    <tr>
      <th>bcVal</th>
      <td><p>a numeric value specifying the lambda parameter to be used in the Box-Cox transformation.</p></td>
    </tr>
    <tr>
      <th>bcAdd</th>
      <td><p>a numeric value specifying the constant to be added on both sides prior to Box-Cox transformation. 
  The default is 0.</p></td>
    </tr>
    <tr>
      <th>start</th>
      <td><p>an optional numeric vector containing starting values for all mean parameters in the model. 
  Overrules any self starter function.</p></td>
    </tr>
    <tr>
      <th>na.action</th>
      <td><p>a function for treating mising values ('NA's). Default is <code>na.omit</code>.</p></td>
    </tr>
    <tr>
      <th>robust</th>
      <td><p>a character string specifying the rho function for robust estimation. Default is non-robust 
  least squares estimation ("mean"). Available robust methods are: median estimation ("median"), 
  least median of squares ("lms"), least trimmed squares ("lts"), metric trimming ("trimmed"), 
  metric winsorizing ("winsor") and Tukey's biweight ("tukey").</p></td>
    </tr>
    <tr>
      <th>logDose</th>
      <td><p>a numeric value or NULL. If log doses value are provided the base of the logarithm should be specified (exp(1) for the natural logarithm
  and 10 for 10-logarithm).</p></td>
    </tr>
    <tr>
      <th>control</th>
      <td><p>a list of arguments controlling constrained optimisation (zero as boundary), 
  maximum number of iteration in the optimisation,
  relative tolerance in the optimisation, warnings issued during the optimisation.</p></td>
    </tr>
    <tr>
      <th>lowerl</th>
      <td><p>a numeric vector of lower limits for all parameters in the model 
  (the default corresponds to minus infinity for all parameters).</p></td>
    </tr>
    <tr>
      <th>upperl</th>
      <td><p>a numeric vector of upper limits for all parameters in the model 
  (the default corresponds to plus infinity for all parameters).</p></td>
    </tr>
    <tr>
      <th>separate</th>
      <td><p>logical value indicating whether curves should be fit separately (independent of each other).</p></td>
    </tr>
    <tr>
      <th>pshifts</th>
      <td><p>a matrix of constants to be added to the matrix of parameters. Default is no shift for all parameters.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function relies on the general optimiser function <code>optim</code> for the minimisation of negative log likelihood function. 
  For a continuous response this reduces to least squares estimation, which is carried out by minimising the following sums of squares</p>  
<p>$$\sum_{i=1}^N [w_i (y_i-f_i)]^2$$</p>  
<p>where \(y_i\), \(f_i\), and \(w_i\) correspond to the observed value, expected value, and the weight respectively, for the ith observation (from 1 to \(N\)).</p>     
<p>The control arguments are specified using the function <code><a href='drmc.html'>drmc</a></code>.</p>  
<p>Setting <code>lowerl</code> and/or <code>upperl</code> automatically invokes constrained optimisation.</p>  
<p>The columns of a data frame argument to <code>pmodels</code> are automatically converted into factors. 
  This does not happen if a list is specified.</p>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class 'drc'.</p>
    
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p><!-- %  The argument \code{curveid} is subsequently used for plotting dose-response curves. For large datasets  -->
<!-- %  it need not represent the actual curves, but it could represent several curves having the parameters  -->
<!-- %  (to avoid too many curves in the plot). The same applies for use with the function \code{\link{ED.drc}}  -->
<!-- %  and \code{\link{SI}}. --></p>
<p>For robust estimation MAD (median abslolute deviance) is used to estimate the residual variance.</p>  
<p><!-- %  The data frame argument allows collapsing parameters for  -->
<!-- %  some or all curves (using \code{\link{colFct}}), whereas the list argument allows specification of  -->
<!-- %  additive models for the parameters. --></p>
    

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>

      <li><a href="#value">Value</a></li>

      <li><a href="#note">Note</a></li>
          </ul>

    <h2>Author</h2>
    Christian Ritz and Jens C. Streibig
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Christian Ritz, Jens C. Streibig.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

